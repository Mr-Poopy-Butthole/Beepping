<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Straight Line Board Travel Calculator</title>
  <link rel="stylesheet" href="/style.css">

  <style>
    /* === Lane Ruler + Layout Overrides for this page === */

    .lane-wrapper {
      position: relative;
      margin-top: 2rem;
      display: flex;
      justify-content: center;
      align-items: flex-start;   /* top-align ruler and lane */
      gap: 10px;
      text-align: left;          /* let lane-label handle its own centering */
    }

    .ruler {
      width: 40px;
      height: 720px; /* 60 ft × 12 px */
      position: relative;
      background: #0d0d0d;
      border: 1px solid #333;
      border-radius: 6px;
      box-shadow: 0 0 12px rgba(0, 0, 0, 0.7);
    }

    .tick-major,
    .tick-minor {
      position: absolute;
      left: 4px;
      transform: translateY(50%);  /* match .distance-line behavior */
    }

    .tick-major {
      width: 24px;
      height: 2px;
      background: #ffffffaa;
    }

    .tick-major-label {
      position: absolute;
      left: 4px;
      color: #bbb;
      font-size: 0.7rem;
      /* slight offset so text sits just above the tick */
      transform: translateY(50%);
    }

    .tick-minor {
      width: 18px;
      height: 1px;
      background: #888;
    }

    .ruler-dot {
      position: absolute;
      left: 12px;
      width: 4px;
      height: 4px;
      border-radius: 50%;
      background: #666;
    }

    /* === Straight Line Path Canvas === */
    #straightCanvas {
      position: absolute;
      inset: 0;
      pointer-events: none;
    }

    /* Keep the lane label nicely centered under just the lane-container */
    .lane-container {
      position: relative;
      width: 312px;
    }

    .lane-label {
      margin-top: 0.5rem;
      text-align: center;
      font-size: 0.85rem;
      color: #ccc;
    }
  </style>
</head>

<body>
<header class="site-header">
  <h1 class="site-title"><a href="/">Beepping</a></h1>
  <nav class="site-nav">
    <a href="/">Home</a>
    <a href="/about.html">About</a>
    <a href="/board-travel.html">Board Travel Calculator</a>
  </nav>
</header>

<main class="center">
  <h2>Straight-Line Aiming Calculator (Right-Handed)</h2>
  <p>
    Enter your <strong>release board</strong> at the foul line and your
    <strong>target board</strong> at the arrows (15 ft). This tool shows where the ball
    would go <em>with zero friction / zero hook</em>.
  </p>

  <form id="travelForm">
    <p>
      <label>
        Release Board (0 = far right gutter, 39 = far left):
        <input type="number" id="releaseBoard" min="0" max="39" required>
      </label>
    </p>

    <p>
      <label>
        Arrow Board (at 15 ft):
        <input type="number" id="arrowBoard" min="0" max="39" required>
      </label>
    </p>

    <p>
      <button type="submit">Calculate Straight Path</button>
    </p>
  </form>

  <div id="output" class="result-box"></div>

  <div class="lane-wrapper">

    <!-- LEFT SIDE RULER -->
    <div class="ruler" id="ruler"></div>

    <!-- Lane + Straight Line Canvas -->
    <div class="lane-container">
      <canvas id="straightCanvas" width="312" height="720"></canvas>

      <div class="lane">
        <div class="foul-line"></div>
        <div class="headpin-line"></div>

        <!-- Distance lines at 15, 30, 45 ft -->
        <div class="distance-line line-15">15 ft</div>
        <div class="distance-line line-30">30 ft</div>
        <div class="distance-line line-45">45 ft</div>

        <!-- Pin deck and pins 1–10 (unchanged) -->
        <div class="pin-deck">
          <div class="pin pin-7">7</div>
          <div class="pin pin-8">8</div>
          <div class="pin pin-9">9</div>
          <div class="pin pin-10">10</div>

          <div class="pin pin-4">4</div>
          <div class="pin pin-5">5</div>
          <div class="pin pin-6">6</div>

          <div class="pin pin-2">2</div>
          <div class="pin pin-3">3</div>

          <div class="pin pin-1">1</div>
        </div>
      </div>

      <p class="lane-label">
        Right-handed lane orientation: 0 = far right, 39 = far left
      </p>
    </div>
  </div>
</main>

<script>
/* ===========================
   HELPER FUNCTIONS
   =========================== */
function boardToX(board) {
  // 1 board = 8px. Righty orientation: 0 = right side (x large), 39 = left side (x small)
  return 312 - board * 8;
}

function ftToY(ft) {
  // Lane & canvas are 720px tall; 0 ft = bottom, 60 ft = top
  return 720 - ft * 12;
}

/* ===========================
   BUILD RULER
   =========================== */
(function buildRuler() {
  const ruler = document.getElementById("ruler");

  for (let ft = 0; ft <= 60; ft++) {
    const y = ft * 12;

    // 1 ft dots
    if (ft > 0 && ft < 60) { // optional: skip endpoints if you want a cleaner look
      const dot = document.createElement("div");
      dot.className = "ruler-dot";
      dot.style.bottom = y + "px";
      ruler.appendChild(dot);
    }

    // Minor ticks every 5 ft (but not major markers)
    if (ft % 5 === 0 && ft % 15 !== 0 && ft !== 0 && ft !== 60) {
      const tick = document.createElement("div");
      tick.className = "tick-minor";
      tick.style.bottom = y + "px";
      ruler.appendChild(tick);
    }

    // Major ticks at 15, 30, 45, 60
    if (ft === 15 || ft === 30 || ft === 45 || ft === 60) {
      const tick = document.createElement("div");
      tick.className = "tick-major";
      tick.style.bottom = y + "px";
      ruler.appendChild(tick);

      const label = document.createElement("div");
      label.className = "tick-major-label";
      // push label just above the tick visually
      label.style.bottom = (y + 4) + "px";
      label.textContent = ft + " ft";
      ruler.appendChild(label);
    }
  }
})();

/* ===========================
   STRAIGHT LINE CALCULATION
   =========================== */
document.getElementById("travelForm").addEventListener("submit", function(e) {
  e.preventDefault();

  const R = Number(document.getElementById("releaseBoard").value); // 0–39
  const A = Number(document.getElementById("arrowBoard").value);   // at 15 ft

  const slope = (A - R) / 15; // boards per foot

  function boardAt(d) {
    return R + slope * d;
  }

  const board15 = boardAt(15);
  const board30 = boardAt(30);
  const board45 = boardAt(45);
  const board60 = boardAt(60);

  /* ===========================
     GUTTER DETECTION
     =========================== */
  let gutter = null;
  let gutterDist = null;

  if (slope < 0) {
    // moving RIGHT → check right gutter at board 0
    const d = (0 - R) / slope;
    if (d > 0 && d < 60) {
      gutter = "RIGHT";
      gutterDist = d;
    }
  } else if (slope > 0) {
    // moving LEFT → check left gutter at board 39
    const d = (39 - R) / slope;
    if (d > 0 && d < 60) {
      gutter = "LEFT";
      gutterDist = d;
    }
  }

  /* ===========================
     DRAW STRAIGHT LINE PATH
     =========================== */
  const canvas = document.getElementById("straightCanvas");
  const ctx = canvas.getContext("2d");

  ctx.clearRect(0, 0, 312, 720);

  const x0 = boardToX(R);
  const y0 = ftToY(0);

  const xf = boardToX(board60);
  const yf = ftToY(60);

  // If guttered early, adjust end point
  let endX = xf;
  let endY = yf;
  if (gutterDist) {
    endX = boardToX(boardAt(gutterDist));
    endY = ftToY(gutterDist);
  }

  ctx.strokeStyle = gutterDist ? "#ff4444" : "#00ff88";
  ctx.lineWidth = 3;
  ctx.beginPath();
  ctx.moveTo(x0, y0);
  ctx.lineTo(endX, endY);
  ctx.stroke();

  /* ===========================
     OUTPUT SUMMARY
     =========================== */
  let html = `
    <p><strong>Straight-line prediction (no friction):</strong></p>
    <p>Board at 15 ft: <strong>${board15.toFixed(1)}</strong></p>
    <p>Board at 30 ft: <strong>${board30.toFixed(1)}</strong></p>
    <p>Board at 45 ft: <strong>${board45.toFixed(1)}</strong></p>
    <p>Board at 60 ft: <strong>${board60.toFixed(1)}</strong></p>
  `;

  if (gutterDist) {
    html += `
      <p style="color:#ff6666;">
        ⚠️ This line goes into the <strong>${gutter} gutter</strong> at
        approximately <strong>${gutterDist.toFixed(1)} ft</strong>.
      </p>`;
  } else {
    html += `<p style="color:#00ff88;">✔ This line stays on the lane through the pins.</p>`;
  }

  document.getElementById("output").innerHTML = html;
});
</script>

</body>
</html>
